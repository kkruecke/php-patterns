<h1>Reusable Obserable trait</h1>

<p>Reuseable Observer Pattern implementation. This code uses the <code>trait Observable</code> to implement reusable observer code. The example obsever is <br />
Quackologist. A Quackologist observes various types of duck classes that implement the interfaces <strong>\SplSubject</strong> and <strong>Quackable</strong>. </p>

<pre><code>class Quackologist implements \SplObserver {

  public function update(\SplSubject $subject) 
  {
     echo ". $subject-&gt;whoami() . " just quacked.\n\n";
  }
}
</code></pre>

<p>The reusable Observable trait looks like this</p>

<p>/*
    *  Observable is the reusable implementation of SplSubject abstract methods.
    */
   trait Observable { </p>

<pre><code> private $observers = array();

 public function attach ( \SplObserver $observer )
 {
   $this-&gt;observers[spl_object_hash($observer)] = $observer;
 }

 public function detach( \SplObserver $observer )
 {
   unset($this-&gt;observers[spl_object_hash($observer)]); 
 }

 public function notify()
 {
    foreach($this-&gt;observers as $observer) {

         $observer-&gt;update($this);  
    }
 }
</code></pre>

<p>}</p>

<p>The subject duck classes implement quack() and whoami().</p>

<p>interface Quackable  {</p>

<pre><code>  function quack();
</code></pre>

<p>}</p>

<p>class RedheadDuck implements Quackable, \SplSubject {
        use Observable; </p>

<pre><code>public function __construct() {}

public function quack() 
    {
   echo "Quack";
   $this-&gt;notify();
}
    public function whoami() { return "Redhead Duck"; }
}
</code></pre>

<p>The main code instantiates ducks and then attaches a Quackologist observer to each.</p>

<pre><code>$array_of_duck = array();

$array_of_ducks[] = new RedheadDuck();

$quackologist = new Quackologist();

foreach ($array_of_ducks as $duck) {

   $duck-&gt;attach($quackologist);
}

foreach ($array_of_ducks as $duck) {

   $duck-&gt;quack(); 
}
</code></pre>

<h2>Note</h2>

<p>Even though <strong>Quackologist::update(\SplSubject)</strong> takes a reference to \SplSubject, this will not result in a compile error, unlike in C++, which would complain</p>

<pre><code>error: no member named 'whoami' in 'Base'
</code></pre>

<p>because Base has not whoami() method. As long as you pass at runtime a class derived from <strong>\SplSubject</strong> that implements <strong>whoami()</strong>, this code will work. Only if
--at runtime--you pass an SplSubject instance that does not implement whoami() will you get an error. </p>
